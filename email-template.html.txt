<!DOCTYPE html>
<html>
<head>
    <title>Monthly Performance Report</title>
</head>
<body style="font-family: 'Inter', sans-serif; margin: 0; padding: 0; background-color: #F0F8F5; color: #111827;">
    <table width="100%" border="0" cellspacing="0" cellpadding="0" style="background-color: #F0F8F5;">
        <tr>
            <td align="center">
                <table width="800" border="0" cellspacing="0" cellpadding="20" style="background-color: #FFFFFF; margin: 30px auto; border-radius: 12px; border: 1px solid #E5E7EB;">
                    <!-- Header -->
                    <tr>
                        <td style="text-align: center; border-bottom: 1px solid #E5E7EB; padding-bottom: 20px;">
                            <h1 style="margin: 0; font-size: 2.2em; font-weight: 800; color: #00B14F;">Monthly Performance Report</h1>
                            <p style="margin: 5px 0 0; color: #6B7280; font-size: 1.1em;">For the period: <?= startDate ?> to <?= endDate ?></p>
                        </td>
                    </tr>
                    <!-- Scorecards -->
                    <tr>
                        <td>
                            <h2 style="font-size: 1.6em; font-weight: 700; margin: 20px 0;">Task Summary</h2>
                            <table width="100%" border="0" cellspacing="0" cellpadding="10">
                                <tr>
                                    <? var scorecards = productionSummary.totalCounts; ?>
                                    <td align="center" style="border: 1px solid #E5E7EB; border-radius: 8px; padding: 15px;">
                                        <div style="font-size: 1em; font-weight: 600; color: #6B7280;">Completed</div>
                                        <div style="font-size: 2.5em; font-weight: 700; color: #111827;"><?= scorecards.Completed || 0 ?></div>
                                    </td>
                                    <td align="center" style="border: 1px solid #E5E7EB; border-radius: 8px; padding: 15px;">
                                        <div style="font-size: 1em; font-weight: 600; color: #6B7280;">In Progress</div>
                                        <div style="font-size: 2.5em; font-weight: 700; color: #111827;"><?= scorecards['In Progress'] || 0 ?></div>
                                    </td>
                                    <td align="center" style="border: 1px solid #E5E7EB; border-radius: 8px; padding: 15px;">
                                        <div style="font-size: 1em; font-weight: 600; color: #6B7280;">Escalated</div>
                                        <div style="font-size: 2.5em; font-weight: 700; color: #111827;"><?= scorecards.Escalated || 0 ?></div>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <!-- Attendance Summary -->
                    <tr>
                        <td>
                            <h2 style="font-size: 1.6em; font-weight: 700; margin: 20px 0;">Attendance Summary</h2>
                            <table width="100%" border="0" cellspacing="0" cellpadding="10" style="border: 1px solid #E5E7EB; border-radius: 8px;">
                                <tr style="background-color: #F0F8F5; font-weight: 700;">
                                    <td style="padding: 12px 15px;">Agent Name</td>
                                    <td style="padding: 12px 15px;">Total Work Duration</td>
                                    <td style="padding: 12px 15px;">Total Break Duration</td>
                                    <td style="padding: 12px 15px;">Total Meeting Duration</td>
                                </tr>
                                <? for (var i = 0; i < attendanceSummary.length; i++) { ?>
                                    <tr>
                                        <td style="padding: 12px 15px; border-top: 1px solid #E5E7EB;"><?= attendanceSummary[i].agentName ?></td>
                                        <td style="padding: 12px 15px; border-top: 1px solid #E5E7EB;"><?= formatDuration(attendanceSummary[i].totalWorkDurationSeconds) ?></td>
                                        <td style="padding: 12px 15px; border-top: 1px solid #E5E7EB;"><?= formatDuration(attendanceSummary[i].totalBreakDurationSeconds) ?></td>
                                        <td style="padding: 12px 15px; border-top: 1px solid #E5E7EB;"><?= formatDuration(attendanceSummary[i].totalMeetingDurationSeconds) ?></td>
                                    </tr>
                                <? } ?>
                            </table>
                        </td>
                    </tr>
                    <!-- Charts -->
                    <tr>
                        <td>
                             <h2 style="font-size: 1.6em; font-weight: 700; margin: 20px 0;">Visual Insights</h2>
                             <table width="100%" border="0" cellspacing="0" cellpadding="10">
                                <tr>
                                    <td align="center"><img src="cid:marketChart" style="max-width: 100%;" /></td>
                                    <td align="center"><img src="cid:tatChart" style="max-width: 100%;" /></td>
                                 </tr>
                                 <tr>
                                     <td align="center"><img src="cid:ahtByCategoryChart" style="max-width: 100%;" /></td>
                                     <td align="center"><img src="cid:leaderboardChart" style="max-width: 100%;" /></td>
                                 </tr>
                             </table>
                        </td>
                    </tr>
                    <!-- Leaderboard -->
                    <tr>
                        <td>
                            <h2 style="font-size: 1.6em; font-weight: 700; margin: 20px 0;">Agent Leaderboard</h2>
                            <table width="100%" border="0" cellspacing="0" cellpadding="10" style="border: 1px solid #E5E7EB; border-radius: 8px;">
                                <tr style="background-color: #F0F8F5; font-weight: 700;">
                                    <td style="padding: 12px 15px;">Rank</td>
                                    <td style="padding: 12px 15px;">Agent Name</td>
                                    <td style="padding: 12px 15px;">Cases Completed</td>
                                    <td style="padding: 12px 15px;">Avg. Handling Time</td>
                                </tr>
                                <? for (var i = 0; i < leaderboardData.length; i++) { ?>
                                    <tr>
                                        <td style="padding: 12px 15px; border-top: 1px solid #E5E7EB;"><?= leaderboardData[i].rank ?></td>
                                        <td style="padding: 12px 15px; border-top: 1px solid #E5E7EB;"><?= leaderboardData[i].agentName ?></td>
                                        <td style="padding: 12px 15px; border-top: 1px solid #E5E7EB;"><?= leaderboardData[i].totalCases ?></td>
                                        <td style="padding: 12px 15px; border-top: 1px solid #E5E7EB;"><?= formatDuration(leaderboardData[i].avgHandlingTime) ?></td>
                                    </tr>
                                <? } ?>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</body>
</html>
